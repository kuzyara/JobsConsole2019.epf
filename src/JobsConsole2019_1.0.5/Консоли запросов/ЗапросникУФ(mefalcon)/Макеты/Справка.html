<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html xmlns:o="urn:schemas-microsoft-com:office:office"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta><link rel="stylesheet" type="text/css" href="__STYLE__"></link><meta name="GENERATOR" content="MSHTML 11.00.10570.1001"></meta></head><body>
<p>Обработка "Запросник" предназначена для составления и исполнения запросов 1С:Предприятия 8.</p>
<h3><font color="#1a7ee2">Список запросов</font></h3>
<p>В левой верхней части основной формы располагается список запросов, составленных пользователем. Возможно добавление, удаление, перемещение элементов этого списка. По двойному щелчку мыши по строке списка происходит выполнение выбранного запроса. Управление списком осуществляется с помощью блока кнопок командной панели.</p>
<p>Список запросов при необходимости можно скрыть используя гиперссылку "Скрыть/показать список запросов". При открытии обработки со списком содержащим один запрос - список автоматически скрывается.</p>
<p>Созданный список запросов можно сохранить в файле с расширением sel. </p>
<h3><font color="#1a7ee2">Текст запроса</font></h3>
<p class="Usual">В правой верхней части обработки располагается непосредственно текст текущего элемента списка запроса. </p>
<p class="Usual">В контекстном меню текста запроса добавлены следующие пункты:</p>
<p class="Usual"><font color="#a52a2a"><strong>Комментировать</strong></font> - установить символы комментария (//)  на выделенные строки текста запроса.</p>
<p class="Usual"><font color="#a52a2a"><strong>Снять комментарий</strong></font> - снять символы комментария (//)  с выделенных строк текста запроса.</p>
<p class="Usual"><font color="#a52a2a"><strong>Удалить символы модуля - </strong></font><font color="#000000">очистить текст запроса, перенесенный из программного модуля от символов "|", ";" и кавычек.</font></p>
<p class="Usual">В нижнем правом углу поля текста запроса располагаются кнопки для копирования текста запроса в буфер. Верхняя кнопка копирует текст запроса в буфер как есть, нижняя кнопка открывает окно с кариантами текста запроса для вставки в программный модуль.</p>
<p class="Usual"><strong><font color="#a52a2a">Кнопка "Конструктор запроса"</font></strong> над текстом запроса служит для редактирования текста запроса с помощью конструктора. </p>
<p class="Usual"><strong><font color="#a52a2a">Кнопка "Параметры"</font></strong> открывает диалог для установки значений параметров запроса. <br>В первой колонке указывается имя параметра. Во второй колонке указывается признак, позволяющий задать значение параметра выражением на встроенном языке 1С:Предприятия 8. В третьей колонке указывается собственно параметр запроса, который может быть задан непосредственно значением или выражением на встроенном языке. Список параметров текущего запроса можно получить нажатием кнопки <font color="#000040"><strong>"Из запроса". </strong></font></p>
<p><font color="#000000">Неиспользуемые в запросе параметры отображаются в списке серым цветом. Кнопка "Удалить неиспользуемые" очищает список параметров от неиспользуемых в текущем запросе параметров.</font></p>
<p class="Usual">Диалог настройки параметров открывается автоматически если после редактирования текста в конструкторе в запросе появились новые параметры.</p>
<p class="Usual">Кнопка "Момент времени / Граница" служит для задания значения параметров типа Момент времени или Граница.</p>
<p class="Usual">Кнопка "СЗ" служит для редактирования параметров типа "Список значений".</p>
<p class="Usual">Кнопка "ТЗ" служит для редактирования параметров типа "Таблица значений".  Предусмотрена возможность задавать структуру полей таблицы значений и содержимое строк.</p>
<p class="Usual"><strong><font color="#a52a2a">Кнопка "Выборки"</font></strong> открывает диалог для настроить правила выборки данных из результата запроса.</p>
<p class="Usual">Предусмотрено 2 режима выгрузки результата запроса в таблицу/дерево:</p><font color="#000040">
<ul><li>
<div><font color="#000000">Стандартная выгрузка результата - используется метод Выгрузить() результата запроса;</font></div>
</li><li>
<div><font color="#000000">По списку настроенных выборок - используется таблица настроенных выборок из результата запроса. Используется вложенный вызов метода Выбрать() к описанным выборкам из запроса. Т.е. первая выборка получается из результата запроса, а каждая последующая - выборкой из предыдущей.</font></div></li></ul><p><font color="#000000">Автоматическую настройку выборок можно выполнить нажав кнопку <strong>"Из запроса".</strong> Выборки создаются исходя из того, как они описаны в итогах запорса.</font></p>
<p class="Usual"><font color="#000000">При работе с настроенными выборками становится доступным флажок "Обходить иерархические выборки рекурсивно". При установленном флажке обход иерархических выборок осуществляется рекурсивно до нижнего уровня. При снятом флажке иерархическая выборка вернет только единственный уровень иерархии результата.</font></p>
<p class="Usual"><font color="#000000">При формировании результата по списку настроенных выборок, становится доступным флажок "Показать типы записей и уровни группировок". При включении данного режима в результате запроса будут отображены дополнительные колонки для отображения типов записей и уровней группировок строк результата.</font></p></font>
<p class="Usual"><strong><font color="#a52a2a">Кнопка "Выполнить запрос"</font></strong> - выполняет текущий запрос. В дополнительном меню кнопки предусмотрено выполнение только выделенной части текста запроса.</p>
<p class="Usual">В правом верхнем углу поля текста запроса расположена кнопка открытия текста запроса в отдельном максимизированном окне для более удобного редактирования.</p>
<p class="Usual">В правом нижнем углу поля текста запроса расположена кнопки копирования в буфер как самого текста запроса, так и фрагмента програмного модуля с описанием запроса и установкой его параметров. </p>
<h3><font color="#1a7ee2">Версии запроса</font></h3>
<p>В Запроснике ведется хранение версий запроса. При выполнении нового или измененного запроса сохраняется его версия (текст запроса и параметры). Когда версий больше одной - рядом с кнопкой "Выполнить запрос" появляются кнопки для управления версиями: кнопки со стрелками для перехода по версиям, кнопка "..." - окрывает окно для просмотра сохраненных версий. В открытом окне можно вернуться к любой версии запроса. При сохранении файла запросов информация о версиях также сохраняется.</p>
<h3><font color="#1a7ee2">Результат запроса</font></h3>
<p class="Usual">В нижней части обработки располагается результат запроса. Слева над результатом можно указать способ выгрузки: таблица значений или дерево значений.</p>
<p class="Usual">На закладке "Результат" находится таблица или дерево результата выполнения запроса (в зависимости от способа выгрузки). </p>
<p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 115%; mso-bidi-font-size: 11.0pt">На закладке «Временные таблицы» можно посмотреть содержимое временных таблиц запроса. <o:p></o:p></span></p><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 115%; mso-bidi-font-size: 11.0pt">
<p>Закладка "Временные таблицы" отображается только когда в результате запроса присутствуют временные таблицы. Заголовок закладки содержит информацию о количестве временных таблиц.</p>
<p>При переходе на закладку "Временные таблицы" или при выборе временной таблицы на данной закладке, открывается диалог с информацией о временных таблицах (имя таблицы, время выполнения, количество строк). </p>
<p></p></span><span style="FONT-SIZE: 12pt; LINE-HEIGHT: 115%; mso-bidi-font-size: 11.0pt">Для просмотра содержимого временной таблицы необходимо дважды кликнуть на нужной строке диалога. В результате в табличной части закладки "Временные таблицы" будет отображено содержимое выбранной таблицы, над которым показано время выполнения ее запроса.<o:p></o:p></span> 
<p>На закладке "Временные таблицы" и в списке временных таблиц расположена кнопка "Отладить". При нажатии на нее в дереве запросов создается новый запрос, подчиненный основному запросу. В текст запроса переносится фрагмент основного запроса, связанный с формированием временной таблицы. Также переносятся значения параметров запроса, использующиеся во временной таблице. Следует иметь ввиду, что таким образом можно отлаживать только те временные таблицы, данные для которых берутся непосредственно из базы данных. Т.е. временную таблицу, использующую данные других временных таблиц, описанных в запросе ранее, таким способом отлаживать нельзя.</p>
<p class="Usual"></p>
<p class="Usual">Над результатом запроса в центре формы отображается информация о времени выполнения запроса. Данный показатель учитывает только время выполнения самого запроса без учета времени вывода запроса в результат.</p>
<p class="Usual">В правом нижнем углу отобрадается количество строк в реультате запроса (только в режиме Таблица).</p>
<p class="Usual">Сверху и справа от результата находится кнопка открытия результата запроса в отдельном максимизированном окне для более удобного просмотра и анализа.</p>
<p class="Usual">Нажатие данной кнопки всегда открывает новое окно с результатом. Таким образом моно открыть и сравнивать различные результаты как различных запросов, так и одного запроса с разными значениями настроек параметров и выборок.</p>
<h3><font color="#1a7ee2">Выполнение алгоритма над результатом запроса</font></h3>
<p class="Usual">Для выполнения произвольного алгоритма над результатом запроса необходимо нажать кнопку "Выполнить алгоритм..." на закладке "Результат". Выполнение алгоритма возможно только если результат представлен в виде таблицы значений (режим Таблица на закладке "Результат").</p>
<p class="Usual">В открывшемся диалоговом окне необходимо задать требуемый текст программного модуля, который будет выполнен для каждой строки таблицы результата и нажать на кнопку "Выполнить алгоритм". </p>
<p class="Usual">При написании алгоритма для обращения к строке результата необходимо использовать выражение СтрокаРезультата.</p>
<p class="Usual">В левой части формы отображается таблица со списком полей результата запроса. Двойной клик на строке таблицы вставит в текст алгоритма конструкцию СтрокаРезультата.[Поле], где [Поле] - имя выбранного поля.</p>
<p class="Usual">В подменю кнопки "Выполнить алгоритм" находится дополнительный пункт "Выполнить для первой строки". При выборе этого пункта алгоритм выполняется только для первой строки результата. Этот режим рекомендуется использовать для отладки алгоритма.</p>
<h3><font color="#1a7ee2">Отладка запроса</font></h3>
<p>Для отладки запроса в процессе выполнения программного модуля, необходимо после описания и установки параметров запроса вставить код вида:</p>
<p><font color="#0000ff">ВнешниеОбработки.Создать("Q:\1С\8.1\My_EPFs\Запросник81.epf").Отладить(Запрос);</font></p>
<p>где </p>
<p>"Q:\1C\8.1\My_EPFs\Запросник81.epf" - путь к обработке на локальном диске;</p>
<p>Запрос - отлаживаемый запрос.</p>
<p>Для открытия окна запросника в модальном режиме, необходимо в функции Отладить() указать второй необязательный параметр равный Истина, </p>
<p>т.е.</p>
<p><font color="#0000ff">ВнешниеОбработки.Создать("Q:\1С\8.1\My_EPFs\Запросник81.epf").Отладить(Запрос, <strong>Истина</strong>);</font> </p>
<p>В результате в режиме "1С:Предприятие" будет открыто окно обработки с загруженным в нее запросом и установленными параметрами запроса.</p>
<p>В случае открытия в модальном режиме, выполнение последующего кода будет приостановлено до закрытия окна Запросника.</p>
<p>Для просмотра описания по отладке запроса и копирования в буфер пути к Запроснику на локальном диске слудит пункт "Отладка запроса в модуле" в меню действий.</p>
<p class="Usual"><font size="2">Автор доработок: Тезин Владимир <font color="#1a7ee2">(</font></font><a href=""><font color="#1a7ee2" size="2">vtezin@gmail.com</font></a><font size="2">)</font></p>
<p class="Usual"><font size="2">при участии:</font></p>
<p class="Usual"><font size="2">Николаенко Евгений <font color="#1a7ee2">(</font></font><a href=""><font color="#1a7ee2" size="2">MyNanoSoft@mail.ru</font></a><font size="2">)</font></p>
<p class="Usual"><font size="2">Актуальная версия Запросника всегда здесь: <a href="https://sites.google.com/site/vtezin/zaprosnik-1s"><font size="3">https://sites.google.com/site/vtezin/zaprosnik-1s</font></a></font></p></body></html>